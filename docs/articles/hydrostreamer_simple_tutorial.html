<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>hydrostreamer tutorial • hydrostreamer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="hydrostreamer tutorial">
<meta property="og:description" content="hydrostreamer">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hydrostreamer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/hydrostreamer_simple_tutorial.html">hydrostreamer tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mkkallio/hydrostreamer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="hydrostreamer_simple_tutorial_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>hydrostreamer tutorial</h1>
                        <h4 class="author">Marko Kallio</h4>
            
            <h4 class="date">2021-01-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mkkallio/hydrostreamer/blob/master/vignettes/hydrostreamer_simple_tutorial.Rmd"><code>vignettes/hydrostreamer_simple_tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>hydrostreamer_simple_tutorial.Rmd</code></div>

    </div>

    
    
<p>This tutorial aims to explain the workflow in <em>hydrostreamer</em> and showcase some of it’s capabilities. More specific tutorials will be added in time, which concentrate on different parts of hydrostreamer</p>
<div id="using-hydrostreamer" class="section level1">
<h1 class="hasAnchor">
<a href="#using-hydrostreamer" class="anchor"></a>Using <strong>hydrostreamer</strong>
</h1>
<p>Some example data have been included to the package for tutorial purposes. It includes</p>
<ul>
<li><p>1 by 1 degree DEM located in Southeast Asia. The DEM is originally ALOS World 3D at 30 meter resolution (Tanado et al 2014), which has been resampled to 0.005 degree resolution.</p></li>
<li><p>1 by 1 degree runoff timeseries in the same area as the DEM. Runoff is sourced from the Linear Optimal Runoff Aggregate (LORA) at 0.5 degree resolution (see Hobeichi et al 2019). The unit of runoff is mm/s (kg/m2/s), and are provided with a monthly timestep.</p></li>
<li><p>A river network derived from the provided DEM with 216 river segments.</p></li>
<li><p>River segment specific catchment areas, delineated from the provided DEM. Catchments are provided for a subset (n = 41) of the river segments.</p></li>
</ul>
<p>Let’s first load the data and inspect it:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mkkallio.github.io/hydrostreamer/">hydrostreamer</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">example_rivers</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">example_basins</span><span class="op">)</span>
<span class="va">runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html">brick</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"runoff.tif"</span>, package <span class="op">=</span> <span class="st">"hydrostreamer"</span><span class="op">)</span><span class="op">)</span>
<span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html">brick</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"dem.tif"</span>, package <span class="op">=</span> <span class="st">"hydrostreamer"</span><span class="op">)</span><span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">runoff</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">basins</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">river</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">basins</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">river</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-1-2.png" width="700"></p>
<p><em>hydrostreamer</em> main workflow occurs in three steps:</p>
<ol style="list-style-type: decimal">
<li>Areal interpolation of runoff to explicit river segments</li>
<li>Routing down the river network to estimate discharge</li>
<li>Model averaging, if streamflow observations are available.</li>
</ol>
<div id="converting-raster-runoff-to-a-polygon-network" class="section level2">
<h2 class="hasAnchor">
<a href="#converting-raster-runoff-to-a-polygon-network" class="anchor"></a>1. Converting raster runoff to a polygon network</h2>
<p>The raster layers are converted to polygons in order to do all the computations using only vector processing, and thus. Each cell of the raster is polygonized, and if an area of interest is provided, the polygons are clipped to it. This removes any unneeded grid cells. The resulting <strong>HS</strong> object is a standard ‘sf’ object with information about each raster cell. The runoff timeseries can be found in a named list column <em>runoff_ts</em>. The elements are named by the ID, and can be accessed with the ‘$’ notation.</p>
<p>We use <strong>raster_to_HS</strong> to convert a raster timeseries to a HS object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">source_runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/raster_to_HS.html">raster_to_HS</a></span><span class="op">(</span><span class="va">runoff</span>, 
                       unit <span class="op">=</span> <span class="st">"mm/s"</span>,
                       date <span class="op">=</span> <span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"1980-01-01"</span><span class="op">)</span>, 
                       timestep <span class="op">=</span> <span class="st">"month"</span>, 
                       aoi <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">basins</span><span class="op">)</span>,
                       names <span class="op">=</span> <span class="st">"LORA"</span><span class="op">)</span>
<span class="va">source_runoff</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hydrostreamer</span>
<span class="co">#&gt; No. objects: 4</span>
<span class="co">#&gt; No. runoff timeseries: 1</span>
<span class="co">#&gt;   Included runoff timeseries: LORA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Simple feature collection with 4 features and 2 fields</span>
<span class="co">#&gt; geometry type:  POLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 107.275 ymin: 12.25 xmax: 107.625 ymax: 12.995</span>
<span class="co">#&gt; CRS:            +proj=longlat +datum=WGS84 +no_defs</span>
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   zoneID runoff_ts                                                      geometry</span>
<span class="co">#&gt;    &lt;int&gt; &lt;named list&gt;                                              &lt;POLYGON [°]&gt;</span>
<span class="co">#&gt; 1      1 &lt;tibble [396 x~ ((107.5 12.995, 107.5 12.5, 107.31 12.5, 107.31 12.505~</span>
<span class="co">#&gt; 2      2 &lt;tibble [396 x~ ((107.625 12.5, 107.615 12.5, 107.5 12.5, 107.5 12.995~</span>
<span class="co">#&gt; 3      3 &lt;tibble [396 x~ ((107.31 12.5, 107.5 12.5, 107.5 12.325, 107.495 12.32~</span>
<span class="co">#&gt; 4      4 &lt;tibble [396 x~ ((107.5 12.5, 107.615 12.5, 107.615 12.485, 107.62 12.~</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">source_runoff</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># access runoff timeseries of the element with ID `2` </span>
<span class="va">source_runoff</span><span class="op">$</span><span class="va">runoff_ts</span><span class="op">$</span><span class="va">`2`</span>
<span class="co">#&gt; # A tibble: 396 x 2</span>
<span class="co">#&gt;    Date               LORA</span>
<span class="co">#&gt;    &lt;date&gt;           [mm/s]</span>
<span class="co">#&gt;  1 1980-01-01 3.548126e-06</span>
<span class="co">#&gt;  2 1980-02-01 1.870791e-06</span>
<span class="co">#&gt;  3 1980-03-01 8.945829e-07</span>
<span class="co">#&gt;  4 1980-04-01 8.163660e-07</span>
<span class="co">#&gt;  5 1980-05-01 5.020849e-07</span>
<span class="co">#&gt;  6 1980-06-01 1.698980e-05</span>
<span class="co">#&gt;  7 1980-07-01 1.985167e-05</span>
<span class="co">#&gt;  8 1980-08-01 2.818044e-05</span>
<span class="co">#&gt;  9 1980-09-01 6.625702e-05</span>
<span class="co">#&gt; 10 1980-10-01 5.431649e-05</span>
<span class="co">#&gt; # ... with 386 more rows</span></code></pre></div>
<p>HS objects can also be created from an ‘sf’ (polygon) object and a runoff timeseries using function <a href="https://mkkallio.github.io/hydrostreamer/reference/create_HS.html">create_HS</a>.</p>
</div>
<div id="areal-interpolation" class="section level2">
<h2 class="hasAnchor">
<a href="#areal-interpolation" class="anchor"></a>2. Areal interpolation</h2>
<p>The four areal interpolation methods shown here are explained in more detail in our recent (2019) conference paper <a href="https://mssanz.org.au/modsim2019/K8/kallio.pdf">here</a>. The following figure is from the publication, visualizing the different methods:</p>
<div class="figure">
<img src="http://markokallio.fi/modsim_fig1_density.png" alt=""><p class="caption">Figure 1. Conceptual presentation of the areal interpolation methods and their result. Panel A presents the catchment areas (A1) and ancillary variable (A2) derived from a Digital Elevation Model (A0). Panel B shows the result of applying Areal Interpolation (B1), Dasymetric Mapping (B2), Pycnophylactic Interpolation (B3) and combined Pycnophylactic-Dasymetric Interpolation (B4) to input runoff data (B0).</p>
</div>
<div id="area-weighted-interpolation" class="section level3">
<h3 class="hasAnchor">
<a href="#area-weighted-interpolation" class="anchor"></a>Area Weighted Interpolation</h3>
<p>Hydrostreamer implements several different areal interpolation methods, all of which can be accessed using the <strong>interpolate_runoff</strong> function. The simplest form implemented in hydrostreamer is Area Weighted Interpolation (AWI), which divides runoff from source zones to target river reaches .</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AWI</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolate_runoff.html">interpolate_runoff</a></span><span class="op">(</span><span class="va">source_runoff</span>, <span class="va">basins</span>, riverID <span class="op">=</span> <span class="st">"SEGMENT_ID"</span><span class="op">)</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>
<span class="va">AWI</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hydrostreamer</span>
<span class="co">#&gt; No. objects: 41</span>
<span class="co">#&gt; No. runoff timeseries: 1</span>
<span class="co">#&gt;   Included runoff timeseries: LORA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Simple feature collection with 41 features and 3 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 107.275 ymin: 12.25 xmax: 107.625 ymax: 12.995</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="co">#&gt; # A tibble: 41 x 4</span>
<span class="co">#&gt;    riverID runoff_ts     SEGMENT_ID                                         geom</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;named list&gt;       &lt;dbl&gt;                           &lt;MULTIPOLYGON [°]&gt;</span>
<span class="co">#&gt;  1      56 &lt;tibble [396~         56 (((107.4025 12.255, 107.4 12.255, 107.4 12.~</span>
<span class="co">#&gt;  2      65 &lt;tibble [396~         65 (((107.4225 12.255, 107.43 12.255, 107.43 1~</span>
<span class="co">#&gt;  3      67 &lt;tibble [396~         67 (((107.4875 12.32, 107.485 12.32, 107.485 1~</span>
<span class="co">#&gt;  4      69 &lt;tibble [396~         69 (((107.3325 12.345, 107.33 12.345, 107.33 1~</span>
<span class="co">#&gt;  5      70 &lt;tibble [396~         70 (((107.3825 12.355, 107.38 12.355, 107.38 1~</span>
<span class="co">#&gt;  6      77 &lt;tibble [396~         77 (((107.4875 12.365, 107.485 12.365, 107.485~</span>
<span class="co">#&gt;  7      79 &lt;tibble [396~         79 (((107.575 12.3925, 107.575 12.39, 107.57 1~</span>
<span class="co">#&gt;  8      83 &lt;tibble [396~         83 (((107.565 12.4325, 107.565 12.43, 107.56 1~</span>
<span class="co">#&gt;  9      85 &lt;tibble [396~         85 (((107.5825 12.36, 107.58 12.36, 107.58 12.~</span>
<span class="co">#&gt; 10      88 &lt;tibble [396~         88 (((107.4625 12.355, 107.46 12.355, 107.46 1~</span>
<span class="co">#&gt; # ... with 31 more rows</span></code></pre></div>
<p>The output contains the columns from basins, added with riverID and runoff timeseries converted to volume (cubic meters per second).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AWI</span><span class="op">$</span><span class="va">runoff_ts</span><span class="op">$</span><span class="va">`56`</span>
<span class="co">#&gt; # A tibble: 396 x 2</span>
<span class="co">#&gt;    Date            LORA</span>
<span class="co">#&gt;    &lt;date&gt;        [m3/s]</span>
<span class="co">#&gt;  1 1980-01-01 0.3404937</span>
<span class="co">#&gt;  2 1980-02-01 0.2878624</span>
<span class="co">#&gt;  3 1980-03-01 0.2563814</span>
<span class="co">#&gt;  4 1980-04-01 0.2465635</span>
<span class="co">#&gt;  5 1980-05-01 0.4716301</span>
<span class="co">#&gt;  6 1980-06-01 2.6837455</span>
<span class="co">#&gt;  7 1980-07-01 2.5424214</span>
<span class="co">#&gt;  8 1980-08-01 3.6900426</span>
<span class="co">#&gt;  9 1980-09-01 5.6477615</span>
<span class="co">#&gt; 10 1980-10-01 2.9908853</span>
<span class="co">#&gt; # ... with 386 more rows</span>

<span class="va">AWI</span><span class="op">$</span><span class="va">mean_runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">AWI</span><span class="op">$</span><span class="va">runoff_ts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">LORA</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">AWI</span><span class="op">[</span>,<span class="st">"mean_runoff"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="dasymetric-mapping" class="section level3">
<h3 class="hasAnchor">
<a href="#dasymetric-mapping" class="anchor"></a>Dasymetric Mapping</h3>
<p>We can also refine the estimates using a dasymetric variable. Here I assume that more runoff is generated at higher elevations than lower, which may or may not be a good assumptions. It is, however, easy to extract from the DEM.</p>
<p>In dasymetric mapping (DM), the output of area weighted interpolation is further refined by scaling it using an ancillary variable - in this case elevation.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">elevation_values</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extract.html">extract</a></span><span class="op">(</span><span class="va">dem</span>, <span class="va">basins</span><span class="op">)</span>
<span class="va">basins</span><span class="op">$</span><span class="va">elevation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">elevation_values</span>, <span class="va">mean</span><span class="op">)</span>

<span class="va">DM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolate_runoff.html">interpolate_runoff</a></span><span class="op">(</span><span class="va">source_runoff</span>, <span class="va">basins</span>, dasymetric <span class="op">=</span> <span class="st">"elevation"</span>,
                         riverID <span class="op">=</span> <span class="st">"SEGMENT_ID"</span><span class="op">)</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>

<span class="va">DM</span><span class="op">$</span><span class="va">mean_runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">DM</span><span class="op">$</span><span class="va">runoff_ts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">LORA</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">DM</span><span class="op">[</span>,<span class="st">"mean_runoff"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="pycnophylactic-interpolation" class="section level3">
<h3 class="hasAnchor">
<a href="#pycnophylactic-interpolation" class="anchor"></a>Pycnophylactic Interpolation</h3>
<p>A third possibility is to use Pycnophylactic Interpolation (PP).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">source_runoff</span><span class="op">$</span><span class="va">mean_runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">source_runoff</span><span class="op">$</span><span class="va">runoff_ts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">LORA</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>

<span class="va">PP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolate_runoff.html">interpolate_runoff</a></span><span class="op">(</span><span class="va">source_runoff</span>, <span class="va">basins</span>, pycnophylactic <span class="op">=</span> <span class="st">"mean_runoff"</span>,
                         riverID <span class="op">=</span> <span class="st">"SEGMENT_ID"</span><span class="op">)</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_touches assumes that they are planar</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_touches assumes that they are planar</span>

<span class="va">PP</span><span class="op">$</span><span class="va">mean_runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">PP</span><span class="op">$</span><span class="va">runoff_ts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">LORA</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">PP</span><span class="op">[</span>,<span class="st">"mean_runoff"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="combined-pycnophylactic---dasymetric-interpolation" class="section level3">
<h3 class="hasAnchor">
<a href="#combined-pycnophylactic---dasymetric-interpolation" class="anchor"></a>Combined Pycnophylactic - Dasymetric Interpolation</h3>
<p>The fourth option is to use a combination of PP and DM. In this case, PP is first performed instead of AWI, followed by the same scaling process with the dasymetric variable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PPDM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolate_runoff.html">interpolate_runoff</a></span><span class="op">(</span><span class="va">source_runoff</span>, <span class="va">basins</span>, 
                         dasymetric <span class="op">=</span> <span class="st">"elevation"</span>,
                         pycnophylactic <span class="op">=</span> <span class="st">"mean_runoff"</span>,
                         riverID <span class="op">=</span> <span class="st">"SEGMENT_ID"</span><span class="op">)</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_touches assumes that they are planar</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_touches assumes that they are planar</span>
<span class="va">PPDM</span><span class="op">$</span><span class="va">mean_runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">PPDM</span><span class="op">$</span><span class="va">runoff_ts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">LORA</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">PPDM</span><span class="op">[</span>,<span class="st">"mean_runoff"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="area-to-line-interpolation" class="section level3">
<h3 class="hasAnchor">
<a href="#area-to-line-interpolation" class="anchor"></a>Area-to-Line interpolation</h3>
<p>All of the above examples are using catchment areas as the target units where runoff is estimated. However, existing vector-based river network data may not come specified with the DEM they were created with, or the processing steps are not clearly defined. In such cases, delieating the catchment areas for each segment may be difficult or outright impossible. For such cases, hydrostreamer provides the possibility to do interpolation from the source areas to linestrings. In such case, interpolation is based on the length of the linestring instead of the polygon area.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A2L</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolate_runoff.html">interpolate_runoff</a></span><span class="op">(</span><span class="va">source_runoff</span>, <span class="va">river</span>,
                          riverID <span class="op">=</span> <span class="st">"SEGMENT_ID"</span><span class="op">)</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>

<span class="va">A2L</span><span class="op">$</span><span class="va">mean_runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">A2L</span><span class="op">$</span><span class="va">runoff_ts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">LORA</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">A2L</span><span class="op">[</span>,<span class="st">"mean_runoff"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># DASYMETRIC MAPPING WITH LINES</span>
<span class="va">river</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">river</span>, <span class="va">SEGMENT_ID</span> <span class="op">%in%</span> <span class="va">basins</span><span class="op">$</span><span class="va">SEGMENT_ID</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>elevation <span class="op">=</span> <span class="va">basins</span><span class="op">$</span><span class="va">elevation</span><span class="op">)</span>
<span class="va">A2LDM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolate_runoff.html">interpolate_runoff</a></span><span class="op">(</span><span class="va">source_runoff</span>, <span class="va">river</span>,
                            dasymetric <span class="op">=</span> <span class="st">"elevation"</span>,
                          riverID <span class="op">=</span> <span class="st">"SEGMENT_ID"</span><span class="op">)</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>

<span class="va">A2LDM</span><span class="op">$</span><span class="va">mean_runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">A2LDM</span><span class="op">$</span><span class="va">runoff_ts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">LORA</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">A2LDM</span><span class="op">[</span>,<span class="st">"mean_runoff"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
</div>
<div id="using-both-lines-and-basins" class="section level3">
<h3 class="hasAnchor">
<a href="#using-both-lines-and-basins" class="anchor"></a>Using both lines and basins</h3>
<p>The last example shown here is using both linestrings, and their respective catchment areas. The advantage here is that we can represent the rivers as they are in the network - as connected lines - and still use the catchment areas as a more accurate representation of the runoff produced in the catchment of the segment. In addition, using the lines allows us to use the constant river routing algorithm in the next step instead of only instantaneous routing.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">RB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolate_runoff.html">interpolate_runoff</a></span><span class="op">(</span><span class="va">source_runoff</span>,
                         <span class="va">river</span>,
                         basins <span class="op">=</span> <span class="va">basins</span>,
                         riverID <span class="op">=</span> <span class="st">"SEGMENT_ID"</span><span class="op">)</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>

<span class="va">RB</span><span class="op">$</span><span class="va">mean_runoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">RB</span><span class="op">$</span><span class="va">runoff_ts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">LORA</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">RB</span><span class="op">[</span>,<span class="st">"mean_runoff"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
<div id="apply-river-routing" class="section level2">
<h2 class="hasAnchor">
<a href="#apply-river-routing" class="anchor"></a>3. Apply river routing</h2>
<p>While the runoff generated at each river segment is already useful for many applications, knowing river discharge is often also desirable. hydrostreamer provides two simple river routing algorithms for this purpose: <strong>instantaneous</strong> routing, useful for e.g. estimating runoff in the entire upstream catchment of each river segment, and <strong>constant</strong> flow velocity routing.</p>
<p>Each routing method is accessible through the function <em>accumulate_runoff()</em>. Since the catchment provided here is small, and the timestep in runoff is one month, we’ll just use instantaneous routing here. There would be negligible difference between constant velocity and instantaneous routing in this case.</p>
<p>However, we cannot use the catchments-only downscaled runoff here directly because there is no routing information. Since we can derive the routing information for the river lines, we can use that same routing info for the catchments also.</p>
<p>Note that running <em>river_network()</em> is not explicitly necessary, since the routing algorithm does it automatically if it has not been run in advance.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">routed_river</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/river_network.html">river_network</a></span><span class="op">(</span><span class="va">river</span>, riverID <span class="op">=</span> <span class="st">"SEGMENT_ID"</span><span class="op">)</span>
<span class="va">routed_river</span>
<span class="co">#&gt; Simple feature collection with 41 features and 6 fields</span>
<span class="co">#&gt; geometry type:  LINESTRING</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 107.3325 ymin: 12.2975 xmax: 107.6075 ymax: 12.9975</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hydrostreamer</span>
<span class="co">#&gt; No. objects: 41</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 41 x 7</span>
<span class="co">#&gt;    riverID NEXT  PREVIOUS UP_SEGMENTS SEGMENT_ID                      geom</span>
<span class="co">#&gt;  *   &lt;dbl&gt; &lt;nam&gt; &lt;named &gt;       &lt;dbl&gt;      &lt;dbl&gt;          &lt;LINESTRING [°]&gt;</span>
<span class="co">#&gt;  1      56 &lt;dbl~ &lt;dbl [1~           0         56 (107.4125 12.2975, 107.4~</span>
<span class="co">#&gt;  2      65 &lt;dbl~ &lt;dbl [1~           0         65 (107.4425 12.3425, 107.4~</span>
<span class="co">#&gt;  3      67 &lt;dbl~ &lt;dbl [1~           0         67 (107.5475 12.3625, 107.5~</span>
<span class="co">#&gt;  4      69 &lt;dbl~ &lt;dbl [1~           0         69 (107.3525 12.3675, 107.3~</span>
<span class="co">#&gt;  5      70 &lt;dbl~ &lt;dbl [2~           2         70 (107.3675 12.3725, 107.3~</span>
<span class="co">#&gt;  6      77 &lt;dbl~ &lt;dbl [1~           0         77 (107.5175 12.4125, 107.5~</span>
<span class="co">#&gt;  7      79 &lt;dbl~ &lt;dbl [1~           0         79 (107.5625 12.4275, 107.5~</span>
<span class="co">#&gt;  8      83 &lt;dbl~ &lt;dbl [2~           2         83 (107.5575 12.4375, 107.5~</span>
<span class="co">#&gt;  9      85 &lt;dbl~ &lt;dbl [1~           0         85 (107.5925 12.4475, 107.5~</span>
<span class="co">#&gt; 10      88 &lt;dbl~ &lt;dbl [1~           0         88 (107.4525 12.4575, 107.4~</span>
<span class="co">#&gt; # ... with 31 more rows, and 1 more variable: elevation &lt;dbl&gt;</span>

<span class="va">PPDM</span><span class="op">$</span><span class="va">NEXT</span> <span class="op">&lt;-</span> <span class="va">routed_river</span><span class="op">$</span><span class="va">NEXT</span>
<span class="va">PPDM</span><span class="op">$</span><span class="va">PREVIOUS</span> <span class="op">&lt;-</span> <span class="va">routed_river</span><span class="op">$</span><span class="va">PREVIOUS</span>
<span class="va">PPDM</span><span class="op">$</span><span class="va">UP_SEGMENTS</span> <span class="op">&lt;-</span> <span class="va">routed_river</span><span class="op">$</span><span class="va">UP_SEGMENTS</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">catchment_discharge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/accumulate_runoff.html">accumulate_runoff</a></span><span class="op">(</span><span class="va">PPDM</span>, routing_method <span class="op">=</span> <span class="st">"instant"</span><span class="op">)</span>
<span class="va">river_discharge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/accumulate_runoff.html">accumulate_runoff</a></span><span class="op">(</span><span class="va">RB</span>, routing_method <span class="op">=</span> <span class="st">"instant"</span><span class="op">)</span>

<span class="va">river_discharge</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hydrostreamer</span>
<span class="co">#&gt; No. objects: 41</span>
<span class="co">#&gt; No. runoff timeseries: 1</span>
<span class="co">#&gt;   Included runoff timeseries: LORA</span>
<span class="co">#&gt; No. discharge timeseries: 1</span>
<span class="co">#&gt;   Included discharge timeseries: LORA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Simple feature collection with 41 features and 9 fields</span>
<span class="co">#&gt; geometry type:  LINESTRING</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 107.3325 ymin: 12.2975 xmax: 107.6075 ymax: 12.9975</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="co">#&gt; # A tibble: 41 x 10</span>
<span class="co">#&gt;    riverID NEXT  PREVIOUS runoff_ts discharge_ts UP_SEGMENTS SEGMENT_ID</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;nam&gt; &lt;named &gt; &lt;named l&gt; &lt;named list&gt;       &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1      56 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         56</span>
<span class="co">#&gt;  2      65 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         65</span>
<span class="co">#&gt;  3      67 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         67</span>
<span class="co">#&gt;  4      69 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         69</span>
<span class="co">#&gt;  5      70 &lt;dbl~ &lt;dbl [2~ &lt;tibble ~ &lt;tibble [39~           2         70</span>
<span class="co">#&gt;  6      77 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         77</span>
<span class="co">#&gt;  7      79 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         79</span>
<span class="co">#&gt;  8      83 &lt;dbl~ &lt;dbl [2~ &lt;tibble ~ &lt;tibble [39~           2         83</span>
<span class="co">#&gt;  9      85 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         85</span>
<span class="co">#&gt; 10      88 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         88</span>
<span class="co">#&gt; # ... with 31 more rows, and 3 more variables: geom &lt;LINESTRING [°]&gt;,</span>
<span class="co">#&gt; #   elevation &lt;dbl&gt;, mean_runoff &lt;dbl&gt;</span></code></pre></div>
<p>The algorithm adds a new list column discharge_ts, containing the routed discharge estimates.</p>
<p>We can also plot the estimated discharge from the two approaches at segment 200 by accessing the new list column <em>discharge_ts</em>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">catchment_discharge</span><span class="op">$</span><span class="va">discharge_ts</span><span class="op">$</span><span class="va">`200`</span>, type <span class="op">=</span> <span class="st">'l'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">river_discharge</span><span class="op">$</span><span class="va">discharge_ts</span><span class="op">$</span><span class="va">`200`</span>, col<span class="op">=</span><span class="st">'red'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"PPDM discharge in black, and Area-to-Line discharge in red."</span>,
      sub <span class="op">=</span> <span class="st">"Unit = m3/s, riverID = `200`"</span><span class="op">)</span></code></pre></div>
<p><img src="hydrostreamer_simple_tutorial_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>As seen from the plots, in this catchment the difference between PPDM and Area-to-Line Interpolation is very small. In fact, we’ve found that as the basin size increases, the difference becomes increasingly small. This is particularly true for discharge at a monthly timestep. Larger difference can be expected with a daily timestep and with constant flow velocity routing.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>T. Tadono, H. Ishida, F. Oda, S. Naito, K. Minakawa, H. Iwamoto : Precise Global DEM Generation By ALOS PRISM, ISPRS Annals of the Photogrammetry, Remote Sensing and Spatial Information Sciences, Vol.II-4, pp.71-76, 2014.</p>
<p>Hobeichi, S., Abramowitz, G., Evans, J., and Beck, H. E.: Linear Optimal Runoff Aggregate (LORA): a global gridded synthesis runoff product, Hydrol. Earth Syst. Sci., 23, 851-870, <a href="https://doi.org/10.5194/hess-23-851-2019" class="uri">https://doi.org/10.5194/hess-23-851-2019</a>, 2019.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marko Kallio, Vili Virkki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
