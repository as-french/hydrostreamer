<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Package for Interpolating Distributed Runoff Rroducts on to 
  Explicit River Segments • hydrostreamer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A Package for Interpolating Distributed Runoff Rroducts on to 
  Explicit River Segments">
<meta property="og:description" content="This package provides functions to interpolate multiple 
  distributed runoff data on to an explicitly represented river network, 
  route runoff down the network, and optimise predictions against observed 
  streamflow.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">hydrostreamer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/hydrostreamer_simple_tutorial.html">hydrostreamer tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mkkallio/hydrostreamer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="hydrostreamer-101" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#hydrostreamer-101" class="anchor"></a>hydrostreamer 1.0.1</h1></div>

<p><strong>hydrostreamer</strong> is an R package designed to allow swift investigation of surface water resources from existing distributed runoff datasets with arbitrary areal representations (regular or irregular polygons).</p>
<p>Hydrostreamer workflow generally consists of three steps:</p>
<ol>
<li>Areal interpolation of runoff to explicit river segments</li>
<li>Routing down the river network to estimate discharge</li>
<li>Model averaging, if streamflow observations are available.</li>
</ol>
<p>At the bare minimum, discharge can be estimated using only a single distributed runoff product and a river network. To include model averaging to the step, one further needs additional runoff datasets to provide multiple estimates of discharge, and a reference timeseries to perfgorm model averaging against.</p>
<div id="more-information" class="section level2">
<h2 class="hasAnchor">
<a href="#more-information" class="anchor"></a>More information</h2>
<p><strong>hydrostreamer</strong> has featured in the following publications and conference presentations:</p>
<ul>
<li>Model description paper is under review at Geoscientific Model Development: Kallio, M., Guillaume, J. H. A., Virkki, V., Kummu, M., and Virrantaus, K.: <a href="https://doi.org/10.5194/gmd-2020-276">Hydrostreamer v1.0 – improved streamflow predictions for local applications from an ensemble of downscaled global runoff products</a>, Geosci. Model Dev. Discuss. <br><span class="math display"><em>p</em><em>r</em><em>e</em><em>p</em><em>r</em><em>i</em><em>n</em><em>t</em></span><br>, <a href="https://doi.org/10.5194/gmd-2020-276" class="uri">https://doi.org/10.5194/gmd-2020-276</a>, in review, 2020.</li>
<li>Nauditt, A., Stahl, K., Rodríguez, E., Birkel, C., Formiga-Johnsson, R. M., Kallio, M., Hann, H., Ribbe, L., Baez-Villanueva, O. M., and Thurner, J.: <a href="https://doi.org/10.5194/nhess-2020-360">Tropical drought risk: estimates combining gridded vulnerability and hazard data</a>, Nat. Hazards Earth Syst. Sci. Discuss. <br><span class="math display"><em>p</em><em>r</em><em>e</em><em>p</em><em>r</em><em>i</em><em>n</em><em>t</em></span><br>, <a href="https://doi.org/10.5194/nhess-2020-360" class="uri">https://doi.org/10.5194/nhess-2020-360</a>, in review, 2020.</li>
<li>MODSIM 2019: Kallio et al, <a href="10.36334/modsim.2019.k8.kallio">Downscaling runoff products using areal interpolation: a combined pycnophylactic-dasymetric method</a>
</li>
<li>EGU 2018: Kallio et al, <a href="https://www.researchgate.net/publication/325066501_Spatial_allocation_of_low_resolution_runoff_model_outputs_to_high_resolution_stream_network">Spatial allocation of low resolution runoff model outputs to high resolution stream network</a>
</li>
<li>AGU 2018: Kallio et al, <a href="https://www.researchgate.net/publication/330213179_Generating_improved_estimates_of_streamflow_using_model_averaging_of_downscaled_runoff_products_under_uncertainty">Generating improved estimates of streamflow using model averaging of downscaled runoff products under uncertainty</a>
</li>
<li>AGU 2018: Virkki et al, <a href="https://www.researchgate.net/publication/331320855_AGU_2018_Poster_Presentation">The value of open-source river discharge estimation in the water governance context of the 3S river basin in Southeast Asia</a>
</li>
<li>EGU 2019: Nauditt et al, <a href="https://meetingorganizer.copernicus.org/EGU2019/EGU2019-18370.pdf">Evaluating drought risk in data scarce tropical catchments</a>
</li>
</ul>
</div>
<div id="installing" class="section level2">
<h2 class="hasAnchor">
<a href="#installing" class="anchor"></a>Installing</h2>
<p><strong>hydrostreamer</strong> is not yet on CRAN, so to install, and needs to be installed from Github.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># devtools::install_github("mkkallio/hydrostreamer")</span></span></code></pre></div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h2>
<p>Hydrostreamer includes some example data for demonstration purposes. First, load example data to R:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(hydrostreamer)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(raster)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">library</span>(sf)</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">data</span>(example_rivers)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">data</span>(example_basins)</span>
<span id="cb2-8"><a href="#cb2-8"></a>runoff &lt;-<span class="st"> </span><span class="kw">brick</span>(<span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"runoff.tif"</span>, <span class="dt">package =</span> <span class="st">"hydrostreamer"</span>))</span></code></pre></div>
<div id="1-convert-raster-timeseries-to-a-hs-object" class="section level3">
<h3 class="hasAnchor">
<a href="#1-convert-raster-timeseries-to-a-hs-object" class="anchor"></a>1. Convert raster timeseries to a <strong>HS</strong> object</h3>
<p>The first step in hydrostreamer is converting runoff into a <em>HS</em> object. For a runoff input in a raster format, use <em>raster_to_HS()</em> function. For input we need the raster, starting date of the timeseries and the granularity of input timesteps.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>source_runoff &lt;-<span class="st"> </span><span class="kw">raster_to_HS</span>(runoff, </span>
<span id="cb3-2"><a href="#cb3-2"></a>                   <span class="dt">date =</span> <span class="kw">ymd</span>(<span class="st">"1980-01-01"</span>), </span>
<span id="cb3-3"><a href="#cb3-3"></a>                   <span class="dt">timestep =</span> <span class="st">"month"</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>                   <span class="dt">unit =</span> <span class="st">"mm/s"</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>                   <span class="dt">aoi =</span> <span class="kw">st_union</span>(basins),</span>
<span id="cb3-6"><a href="#cb3-6"></a>                   <span class="dt">names =</span> <span class="st">"LORA"</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>source_runoff</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">## </span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">## Hydrostreamer</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">## No. objects: 4</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">## No. runoff timeseries: 1</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">##   Included runoff timeseries: LORA</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">## </span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">## Simple feature collection with 4 features and 2 fields</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">## geometry type:  POLYGON</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">## dimension:      XY</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">## bbox:           xmin: 107.275 ymin: 12.25 xmax: 107.625 ymax: 12.995</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">## CRS:            +proj=longlat +datum=WGS84 +no_defs</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">## # A tibble: 4 x 3</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">##   zoneID runoff_ts                                                      geometry</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">##    &lt;int&gt; &lt;named list&gt;                                              &lt;POLYGON [°]&gt;</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">## 1      1 &lt;tibble [396 x~ ((107.5 12.995, 107.5 12.5, 107.31 12.5, 107.31 12.505~</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="co">## 2      2 &lt;tibble [396 x~ ((107.625 12.5, 107.615 12.5, 107.5 12.5, 107.5 12.995~</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co">## 3      3 &lt;tibble [396 x~ ((107.31 12.5, 107.5 12.5, 107.5 12.325, 107.495 12.32~</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co">## 4      4 &lt;tibble [396 x~ ((107.5 12.5, 107.615 12.5, 107.615 12.485, 107.62 12.~</span></span></code></pre></div>
<p>The output of the function is an sf object with each raster cell as their own object, and two attributes: an ID and a list column with timeseries of values for each of the raster cell.</p>
</div>
<div id="2-interpolate" class="section level3">
<h3 class="hasAnchor">
<a href="#2-interpolate" class="anchor"></a>2. Interpolate</h3>
<p>Next, we interpolate the values in the source zones to individual river reaches in the river network.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>interpolated_runoff &lt;-<span class="st"> </span><span class="kw">interpolate_runoff</span>(source_runoff, river, </span>
<span id="cb4-2"><a href="#cb4-2"></a>                                          <span class="dt">riverID =</span> <span class="st">"SEGMENT_ID"</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">## although coordinates are longitude/latitude, st_intersects assumes that they are planar</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>interpolated_runoff</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">## </span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">## Hydrostreamer</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">## No. objects: 41</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">## No. runoff timeseries: 1</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">##   Included runoff timeseries: LORA</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">## </span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">## Simple feature collection with 41 features and 3 fields</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">## geometry type:  LINESTRING</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">## dimension:      XY</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">## bbox:           xmin: 107.3325 ymin: 12.2975 xmax: 107.6075 ymax: 12.9975</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">## geographic CRS: WGS 84</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">## # A tibble: 41 x 4</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">##    riverID runoff_ts     SEGMENT_ID                                         geom</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">##      &lt;dbl&gt; &lt;named list&gt;       &lt;dbl&gt;                             &lt;LINESTRING [°]&gt;</span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="co">##  1      56 &lt;tibble [396~         56 (107.4125 12.2975, 107.4075 12.3025, 107.40~</span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co">##  2      65 &lt;tibble [396~         65 (107.4425 12.3425, 107.4375 12.3475, 107.43~</span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="co">##  3      67 &lt;tibble [396~         67 (107.5475 12.3625, 107.5475 12.3675, 107.54~</span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="co">##  4      69 &lt;tibble [396~         69 (107.3525 12.3675, 107.3575 12.3675, 107.36~</span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="co">##  5      70 &lt;tibble [396~         70 (107.3675 12.3725, 107.3725 12.3775, 107.37~</span></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="co">##  6      77 &lt;tibble [396~         77 (107.5175 12.4125, 107.5175 12.4175, 107.51~</span></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="co">##  7      79 &lt;tibble [396~         79 (107.5625 12.4275, 107.5575 12.4325, 107.55~</span></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="co">##  8      83 &lt;tibble [396~         83 (107.5575 12.4375, 107.5625 12.4425, 107.56~</span></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="co">##  9      85 &lt;tibble [396~         85 (107.5925 12.4475, 107.5875 12.4525, 107.58~</span></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="co">## 10      88 &lt;tibble [396~         88 (107.4525 12.4575, 107.4475 12.4625, 107.44~</span></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="co">## # ... with 31 more rows</span></span></code></pre></div>
<p>The warning received here is from the sf package because the coordinate system in the example dataset is in geographic coordinate system. The warning goes away if we first project the dataset to an appropriate coordinate reference system.</p>
<p>The output changes so that zoneID identifying the source of runoff becomes riverID. runoff_ts now contains timeseries of the interpolated runoff at each individual river segment.</p>
</div>
<div id="3-apply-river-routing" class="section level3">
<h3 class="hasAnchor">
<a href="#3-apply-river-routing" class="anchor"></a>3. Apply river routing</h3>
<p>Next, we route runoff down the river network in order to estimate discharge at each segment. Since the example data has a monthly timestep, and the river network is a small one, we use the simplest routing algorithm available: instantaneous routing. In this routing method, all runoff is assumed to flow through the entire network at the timestep it is created.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>streamflow &lt;-<span class="st"> </span><span class="kw">accumulate_runoff</span>(interpolated_runoff, <span class="dt">routing_method =</span> <span class="st">"instant"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>streamflow</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">## </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">## Hydrostreamer</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">## No. objects: 41</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">## No. runoff timeseries: 1</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">##   Included runoff timeseries: LORA</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">## No. discharge timeseries: 1</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">##   Included discharge timeseries: LORA</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">## </span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">## Simple feature collection with 41 features and 7 fields</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">## geometry type:  LINESTRING</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">## dimension:      XY</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">## bbox:           xmin: 107.3325 ymin: 12.2975 xmax: 107.6075 ymax: 12.9975</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">## geographic CRS: WGS 84</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">## # A tibble: 41 x 8</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">##    riverID NEXT  PREVIOUS runoff_ts discharge_ts UP_SEGMENTS SEGMENT_ID</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">##      &lt;dbl&gt; &lt;nam&gt; &lt;named &gt; &lt;named l&gt; &lt;named list&gt;       &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">##  1      56 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         56</span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">##  2      65 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         65</span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">##  3      67 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         67</span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">##  4      69 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         69</span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">##  5      70 &lt;dbl~ &lt;dbl [2~ &lt;tibble ~ &lt;tibble [39~           2         70</span></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">##  6      77 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         77</span></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">##  7      79 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         79</span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co">##  8      83 &lt;dbl~ &lt;dbl [2~ &lt;tibble ~ &lt;tibble [39~           2         83</span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co">##  9      85 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         85</span></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">## 10      88 &lt;dbl~ &lt;dbl [1~ &lt;tibble ~ &lt;tibble [39~           0         88</span></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="co">## # ... with 31 more rows, and 1 more variable: geom &lt;LINESTRING [°]&gt;</span></span></code></pre></div>
<p>We see that there are now additional columns. NEXT and PREVIOUS give the routing information for the routing algorithm. discharge_ts is a list column which contains timeseries of the estimated runoff, and UP_SEGMENTS was created with the routing information, giving the number of river reaches upstream of each individual reach in the network.</p>
</div>
<div id="these-functions-are-pipable" class="section level3">
<h3 class="hasAnchor">
<a href="#these-functions-are-pipable" class="anchor"></a>These functions are pipable</h3>
<p>The function usage has been developed so that they are all pipable.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>streamflow &lt;-<span class="st"> </span><span class="kw">raster_to_HS</span>(runoff, </span>
<span id="cb6-2"><a href="#cb6-2"></a>                           <span class="dt">date=</span><span class="kw">ymd</span>(<span class="st">"1980-01-01"</span>), </span>
<span id="cb6-3"><a href="#cb6-3"></a>                           <span class="dt">timestep=</span><span class="st">"month"</span>, </span>
<span id="cb6-4"><a href="#cb6-4"></a>                           <span class="dt">unit =</span> <span class="st">"mm/s"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>                           <span class="dt">aoi=</span><span class="kw">st_union</span>(basins),</span>
<span id="cb6-6"><a href="#cb6-6"></a>                           <span class="dt">names=</span><span class="st">"LORA"</span>) <span class="op">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="st">    </span><span class="kw">interpolate_runoff</span>(river, <span class="dt">riverID =</span> <span class="st">"SEGMENT_ID"</span>) <span class="op">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="st">    </span><span class="kw">accumulate_runoff</span>()</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">## although coordinates are longitude/latitude, st_intersects assumes that they are planar</span></span></code></pre></div>
<p>For a more thorough tutorial, see the included vignette.</p>
</div>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2018 Marko K. Kallio</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/mkkallio/hydrostreamer/">https://​github.com/​mkkallio/​hydrostreamer/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mkkallio/hydrostreamer/issues">https://​github.com/​mkkallio/​hydrostreamer/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Marko Kallio <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-6917-7790" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Vili Virkki <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-2603-3420" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://doi.org/10.5281/zenodo.1214523"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.1214523.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Marko Kallio, Vili Virkki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
